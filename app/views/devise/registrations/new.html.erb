<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header text-center">
          <h2>Sign Up</h2>
          <p class="text-muted">Create your account and organization to get started</p>
        </div>
        <div class="card-body">
          <%= form_with model: resource, as: resource_name, url: registration_path(resource_name), html: { class: "form" }, data: { turbo: false } do |f| %>
            <!-- Name Field -->
            <div class="form-group mb-3">
              <%= f.label :name, "Full Name", class: "form-label" %>
              <%= f.text_field :name, autofocus: true, autocomplete: "name", class: "form-control" %>
            </div>

            <!-- Email Field -->
            <div class="form-group mb-3">
              <%= f.label :email, "Email Address", class: "form-label" %>
              <%= f.email_field :email, autocomplete: "email", class: "form-control" %>
            </div>

            <!-- Phone Field -->
            <div class="form-group mb-3">
              <%= f.label :phone, "Phone Number", class: "form-label" %>
              <%= f.telephone_field :phone, autocomplete: "tel", class: "form-control", required: true %>
            </div>

            <!-- Password Field -->
            <div class="form-group mb-3">
              <%= f.label :password, "Password", class: "form-label" %>
              <%= f.password_field :password, autocomplete: "new-password", class: "form-control" %>
            </div>

            <!-- Confirm Password Field -->
            <div class="form-group mb-3">
              <%= f.label :password_confirmation, "Confirm Password", class: "form-label" %>
              <%= f.password_field :password_confirmation, autocomplete: "new-password", class: "form-control" %>
            </div>

            <!-- Organization Name Field -->
            <div class="form-group mb-3">
              <%= f.label :organization_name, "Organization Name", class: "form-label" %>
              <%= text_field_tag :organization_name, nil, placeholder: "e.g., Malali Division", class: "form-control", required: true %>
              <small class="form-text text-muted">For emergency divisions, enter the division name.</small>
            </div>

            <!-- Organization Address Field -->
            <div class="form-group mb-3">
              <%= label_tag :organization_address, "Organization Address", class: "form-label" %>
              <%= text_field_tag :organization_address, nil, class: "form-control", required: true %>
            </div>

            <!-- Organization Phone Field -->
            <div class="form-group mb-3">
              <%= label_tag :organization_phone, "Organization Phone", class: "form-label" %>
              <%= text_field_tag :organization_phone, nil, class: "form-control", required: true %>
            </div>

            <!-- Organization Type Field -->
            <div class="form-group mb-3">
              <%= label_tag :organization_type, "Organization Type", class: "form-label" %>
              <%= select_tag :organization_type, options_for_select([["Hospital", "hospital"], ["Pharmacy", "pharmacy"], ["Emergency", "emergency"]], "hospital"), class: "form-select", id: "organization_type" %>
            </div>

            <!-- Emergency Fields (Hidden by Default) -->
            <div id="emergency_fields" style="display: none;">
              <!-- State Selection -->
              <div class="form-group mb-3">
                <%= label_tag :state, "State", class: "form-label" %>
                <%= select_tag :state, options_for_select(@states || states), class: "form-select", prompt: "Select a state", required: true %>
              </div>

              <!-- Emergency Organization Type -->
              <div class="form-group mb-3">
                <%= label_tag :emergency_organization_type, "Emergency Organization Type", class: "form-label" %>
                <%= select_tag :emergency_organization_type, options_for_select([["Police", "Police"], ["Fire Service", "Fire Service"], ["Road Safety", "Road Safety"]]), class: "form-select", prompt: "Select emergency type", required: true %>
                <small class="form-text text-muted">Choose the type of emergency organization this division belongs to.</small>
              </div>
            </div>

            <!-- Submit Button -->
            <div class="d-grid">
              <%= f.submit "Sign up", class: "btn btn-primary btn-lg" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById('organization_type').addEventListener('change', function() {
    var emergencyFields = document.getElementById('emergency_fields');
    emergencyFields.style.display = this.value === 'emergency' ? 'block' : 'none';
  });
</script>